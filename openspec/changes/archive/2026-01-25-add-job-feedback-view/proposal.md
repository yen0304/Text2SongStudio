# Proposal: Add Job Feedback View

## Summary

Add the ability to view feedback records associated with generation jobs. Users will be able to see all feedback (ratings, preferences, tags, notes) for the audio samples generated by a specific job, both in a job detail view and in a standalone feedback history page with job filtering.

## Motivation

Currently, feedback is collected and stored per audio sample, but there's no easy way to see all feedback related to a specific generation job. This makes it difficult for users to:

1. Review the overall quality assessment of a generation batch
2. Understand which samples from a job were preferred
3. Track feedback patterns across different jobs

## Scope

### In Scope

- **Backend**: New API endpoint to retrieve feedback by job ID
- **Frontend**: Job detail panel showing associated feedback
- **Frontend**: Feedback history page with job filter capability
- Display: Rating, Preference, Tags, Notes for each feedback record

### Out of Scope

- Modifying the database schema (use existing Job → audio_ids → Feedback relationship)
- Adding new feedback types
- Feedback editing or deletion

## Approach

Use the existing data relationship: `GenerationJob.audio_ids` → `AudioSample.id` → `Feedback.audio_id`

1. Create a new backend endpoint `GET /generate/{job_id}/feedback` that:
   - Fetches the job's `audio_ids`
   - Queries all feedback records for those audio IDs
   - Returns aggregated feedback with audio sample context

2. Create a frontend `JobFeedbackPanel` component that:
   - Displays feedback grouped by audio sample
   - Shows rating stars, preference indicators, tags, and notes
   - Integrates into existing job detail views

3. Enhance the feedback listing page with:
   - Job ID filter parameter
   - Display of associated job information

## Affected Capabilities

- `feedback-collection`: Add requirement for feedback retrieval by job
- `audio-generation`: Add requirement for job feedback aggregation

## Dependencies

- Existing `GenerationJob` model with `audio_ids` field
- Existing `Feedback` model with `audio_id` relationship
- Existing feedback collection API

## Risks

- **Low**: Query performance for jobs with many samples (mitigated by pagination)

## Success Criteria

- [ ] Users can view all feedback for a specific job in the job detail view
- [ ] Users can filter feedback history by job ID
- [ ] Feedback displays rating, preference, tags, and notes
